var m=Object.defineProperty;var P=(o,t,e)=>t in o?m(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var s=(o,t,e)=>(P(o,typeof t!="symbol"?t+"":t,e),e);import{serializable as p,GameObject as g,Behaviour as c,TypeStore as w}from"./needle-engine-967b2617.js";import{V as h}from"./three.module-f305cb49.js";import"./index-58934aff.js";var x=Object.defineProperty,M=Object.getOwnPropertyDescriptor,f=(o,t,e,n)=>{for(var i=n>1?void 0:n?M(t,e):t,r=o.length-1,a;r>=0;r--)(a=o[r])&&(i=(n?a(t,e,i):a(i))||i);return n&&i&&x(t,e,i),i};class l extends c{constructor(){super();s(this,"target",null);s(this,"offset",new h(0,5,-10));s(this,"rotationSpeed",2);s(this,"isRightMouseDown",!1);s(this,"lastMousePosition",{x:0,y:0});s(this,"onMouseDown",e=>{e.button===2&&(this.isRightMouseDown=!0,this.lastMousePosition={x:e.clientX,y:e.clientY})});s(this,"onMouseUp",e=>{e.button===2&&(this.isRightMouseDown=!1)});s(this,"onMouseMove",e=>{if(!this.isRightMouseDown||!this.target)return;const n=e.clientX-this.lastMousePosition.x,i=e.clientY-this.lastMousePosition.y,r=n*this.rotationSpeed*.01,a=i*this.rotationSpeed*.01,d=this.offset.clone(),u=new h(0,1,0),y=new h(1,0,0);d.applyAxisAngle(u,-r),d.applyAxisAngle(y,a),this.offset.copy(d),this.lastMousePosition={x:e.clientX,y:e.clientY}});window.addEventListener("mousedown",this.onMouseDown),window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("mousemove",this.onMouseMove)}lateUpdate(){if(!this.target||!this.gameObject)return;const e=this.gameObject;e.position.set(this.target.position.x+this.offset.x,this.target.position.y+this.offset.y,this.target.position.z+this.offset.z),e.lookAt(this.target.position)}}f([p(g)],l.prototype,"target",2);f([p(h)],l.prototype,"offset",2);class A extends c{constructor(){super();s(this,"speed",5);s(this,"keysPressed",new Set);s(this,"onKeyDown",e=>{this.keysPressed.add(e.key)});s(this,"onKeyUp",e=>{this.keysPressed.delete(e.key)});window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp)}update(){const e=new h;(this.keysPressed.has("ArrowUp")||this.keysPressed.has("w"))&&(e.z-=this.speed*this.context.time.deltaTime),(this.keysPressed.has("ArrowDown")||this.keysPressed.has("s"))&&(e.z+=this.speed*this.context.time.deltaTime),(this.keysPressed.has("ArrowLeft")||this.keysPressed.has("a"))&&(e.x-=this.speed*this.context.time.deltaTime),(this.keysPressed.has("ArrowRight")||this.keysPressed.has("d"))&&(e.x+=this.speed*this.context.time.deltaTime),this.gameObject.position.add(e)}}w.add("CameraFollow",l);w.add("PlayerController",A);
